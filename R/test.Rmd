```{r Setup}
library(pls)
library(GeneSPLS)

set.seed(815)

# Simulating high-dimensional predictor matrix (p >> n)
n <- 10   # Number of observations
p <- 20  # Number of predictors

X <- matrix(rnorm(n * p), nrow = n, ncol = p)  # Random normal predictors

# True coefficients: Only first 5 predictors contribute to Y
beta <- c(rnorm(5, sd = 2), rep(0, p - 5))

# Generating response variable Y with N(0,1) noise
Y <- X %*% beta + rnorm(n)  

sim_data <- data.frame(Y = Y, X)
```

```{r R Implementation}
# Apply PLSR using 'widekernelpls' without validation
pls_model <- plsr(Y ~ .,
                  data = sim_data,
                  ncomp = 5,
                  method = "widekernelpls",
                  validation = "none",
                  center = FALSE)

pls_model$projection
pls_model$coefficients
```

```{r Rcpp Implementation}
pls_cpp = widekernelpls_fit(X, Y, 5, center = FALSE)
pls_cpp$projection
pls_cpp$coefficients
```
